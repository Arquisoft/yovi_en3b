ifndef::imagesdir[:imagesdir: ../images]

[[section-runtime-view]]
== Runtime View

=== User Login

This diagram the action of the user login

[plantuml,"Login",png]
----
@startuml
actor User
participant WebApp
participant GameYEngine
database Database

User -> WebApp: Introduces credentials (user/password)
WebApp -> GameYEngine: Auth Request
GameYEngine -> Database: Searchs for the user and validates password hash
Database --> GameYEngine: Returns the user data (or error)
alt valid credentials
    GameYEngine --> WebApp: Login Ok
    WebApp --> User: Redirects to the game panel
else Invalid credentials
    GameYEngine --> WebApp: Login failed
    WebApp --> User: Shows "Incorrect user / password"
end
@enduml
----

=== User plays the game

This diagram shows the execution of a game

[plantuml,"Game",png]
----
@startuml
actor User
participant WebApp
participant GameYEngine
database Database

User -> WebApp: Selects board size, difficulty
User -> WebApp: Selects 'Play'
WebApp -> GameYEngine: Requests the board
GameYEngine --> WebApp: Returns the board

loop
    User -> WebApp: Plays their turn
    WebApp -> GameYEngine: Sends the board state & Checks if there is a winner
    GameYEngine -> WebApp: Returns whether there is a winner
    break There is a winner!
        WebApp --> User: Shows result of the game
    end
    WebApp -> GameYEngine: Sends the board state & Asks the bot to play
    GameYEngine --> WebApp: Returns the play of the bot 
    WebApp --> User: Shows the play of the bot
end

WebApp -> GameYEngine: Asks to save the data of the game
GameYEngine -> Database: Asks to save the data of the game
@enduml
----

=== Asking for a hint

This diagram represents the user asking for a hint

[plantuml,"Asking for Hint",png]
----
@startuml
actor User
participant WebApp
participant GameYEngine

User -> WebApp: Asks for a hint
WebApp -> GameYEngine: Sends the board state & Asks for the move
GameYEngine --> WebApp: Returns the hint
WebApp --> User: Shows visually the hint

@enduml
----


